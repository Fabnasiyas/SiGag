<body>
  <header>
    <!-- Header Start -->
    <div class="header-area">
      <div class="main-header header-sticky">
        <div class="container-fluid">
          <div class="menu-wrapper">
            <!-- Logo -->
            <div class="logo">
              <a href="/"><h1>Si<span style="color: #ff2020;">Gag</span></h1></a>
            </div>
            <!-- Main-menu -->
            <div class="main-menu d-none d-lg-block">
              {{!-- <nav>
                <ul id="navigation">
                  <li><a href="index.html">Home</a></li>
                  <li><a href="shop.html">shop</a></li>
                  <li><a href="about.html">about</a></li>
                  
                  <li><a href="">Category</a>
                   
                  </li>

                  <li><a href="#">Pages</a>
                    <ul class="submenu">
                      <li><a href='/user-login'>Login</a></li>
                      <li><a href="/cart">Cart</a></li>

                    </ul>
                  </li>
                  <li><a href="contact.html">Contact</a></li>
                </ul>
              </nav> --}}
            </div>
            <!-- Header Right -->
            <div class="header-right">
              <ul>
                <li>
                  <div class="nav-search search-switch">
                    <span class="flaticon-search"></span>
                  </div>
                </li>
                
                <li> <a href="/user-login"><span class="flaticon-user"></span></a></li>
                <li><a href=""><span class="flaticon-shopping-cart"></span></a> </li>
              </ul>
            </div>
          </div>
          <!-- Mobile Menu -->
          <div class="col-12">
            <div class="mobile_menu d-block d-lg-none"></div>
          </div>
        </div>
      </div>
    </div>
    <!-- Header End -->
  </header>
  <main>
{{#unless status}}
    <div class=" text-center mt-3">
      <h1>My Cart</h1>
    </div>

    <!--================Cart Area =================-->
    <section class="cart_area section_padding" style="padding-top: 100px;">
      <div class="container">
        <div class="cart_inner">
          <div class="table-responsive">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col" style="color: black;"><b>Product</b> </th>
                  <th scope="col" style="color: black;"><b>Price</b></th>
                  
                  <th scope="col" style="color: black; padding-left: 70px;"  ><b>Quantity</b></th>
                  {{!-- <th scope="col" style="color: black;"><b>Total</b></th> --}}
                  <th scope="col" style="color: black;"><b>Option</b></th>
                </tr>
              </thead>
              <tbody>
               
                {{#each products}}

                <tr id="cartRow{{this._id}}">
                  
                  <td>
                    <div class="media">
                      <div class="d-flex">
                        <img src="/product-images/{{this.image.filename}}" alt="" />
                      </div>
                      <div class="media-body">
                        <p style="color: black;">{{this.productname}} </p>
                      </div>
                    </div>
                  </td>
                  <td>
                    <h5 id="price{{this._id}}" style="color: black;" >{{this.price}}</h5>
                  </td>
                  <td>
                  
                    {{!-- <a href="/decrement/{{this._id}}" class="btn "> - </a>
                       <input type="text" style="border-style: none; width:35px; color: black; align-items: center;" value="{{this.quantity}}" readonly>
        
                    <a href="/increment/{{this._id}}" class="btn "> + </a>               --}}
                      {{message}}            
                     <button class=" btn mx-2 " onclick="qtyDecrement('{{this._id}}')">-</button>
                     <input id="quantityBox{{this._id}}" value="{{this.quantity}}" style="width: 20px; border-style: none;" readonly>
                     <button class=" btn mx-2" onclick="changeQuantity('{{this._id}}')">+</button>
                  </td>
                  <td>
                    <h5 id="totalPrice{{this._id}}" style="color: black;">{{this.totalprice}}</h5>
                  </td>

                  <td><a href="/removefromcart/{{this._id}}" class="btn">Remove</a></td>
                </tr>

                {{/each}}
                <tr>
                  <td></td>
                  <td></td>
                  <td>
                    <h5 style="color: black;"><b>All Total</b> </h5>
                  </td>
                  <td>
                    <h5  style="color: black;"><b>RS:</b><b id="allamount">{{Allamount}}</b> </h5>
                  </td>
                </tr>

              </tbody>
            </table>
            <div class="checkout_btn_inner float-right">
              <a class="btn_1" href="/viewallproducts">Continue Shopping</a>
              <a class="btn_1 checkout_btn_1" href="/checkout">Proceed to checkout</a>
            </div>
          </div>
        </div>
        {{else}}
         {{!-- <b><h1 style="color: red;"> {{message}}</h1></b> --}}
         <div class="text-center mt-5" >
      <img src="https://cdni.iconscout.com/illustration/premium/thumb/empty-cart-2130356-1800917.png" alt="Empty Cart" style="width: 50%;">
      <h2 style="color: #ff2020;">Your cart is empty!</h2>
      {{/unless}}
       
         
       
     
    </section>

  </main>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
            
<script>
function changeQuantity(prodId){
axios.get('/increment/'+prodId).then((resp)=>{
  console.log(resp)
let quantity= document.getElementById("quantityBox"+prodId)
quantity.value=Number(quantity.value)+1;
let price=document.getElementById('price'+prodId).textContent 
document.getElementById('totalPrice'+prodId).textContent=Number(quantity.value)*Number(price)
let Allamount=document.getElementById('allamount').textContent 
document.getElementById('allamount').textContent=Number(Allamount)+Number(price)
})
}

function qtyDecrement(prodId){
  axios.get('/decrement/'+prodId).then((resp)=>{
    console.log(resp)
    if(resp.data.success){
    let quantity=document.getElementById("quantityBox"+prodId)
   
    quantity.value=Number(quantity.value)-1;
    
    let price=document.getElementById('price'+prodId).textContent
document.getElementById('totalPrice'+prodId).textContent=Number(quantity.value)*Number(price)
let Allamount=document.getElementById('allamount').textContent 
document.getElementById('allamount').textContent=Number(Allamount)-Number(price)
    }
    else{
document.getElementById('cartRow'+prodId).innerHTML=''
    }
  })
}
</script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">

</body> 